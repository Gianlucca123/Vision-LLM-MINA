from Qwen25 import questionQwen, open_Qwen05, open_Qwen15, clean_cuda

def main():
    clean_cuda()
    # Construct the prompt
    pre_prompt="The following is a sequence of frame descriptions of a video."

    context = """
==================================================================================================================================
START OF VIDEO

Frame 1 (00:23) : The image appears to be an in-camera shot of an open-air restaurant or marketplace. Here's a detailed description:\n\n**Setting and Environment:**\n1. **Place:**\n   - The scene is set inside a market area, evidenced by the various stalls and the presence of tables.\n2. **Lighting:**\n   - Natural daylight, possibly from small windows or gaps in the walls, illuminates the interior.\n3. **Clothing:**\n   - The people are dressed casually and comfortably, fitting for informal outdoor dining.\n   - The woman in the center is wearing a white tank top and black shorts.\n\n4. **Tabletops & Equipment:**\n   - There's a table set with several items, including what appears to be a black grill, some cooking containers, and utensils.\n   - Two different people are sitting around this table; one is an older individual using a cell phone, while the other, possibly a child or young person, has brought a plate.\n   - The room is partially open, and there is a tiled floor and multiple chairs scattered around.\n\n**People:**\n1. **Foreground:**\n   - A woman to the left, wearing a white tank top and black shorts, appears to be waiting or reading.\n   - Another woman, dressed in striped pants and a white top, is standing next to her, focused on her mobile device.\n   - Nearby, a child sits on a small chair, eating a plate or bowl.\n   \n2. **Mallory:**\n   - A group of people are casually dining or socializing around the area.\n   - One individual is holding a plate with food, possibly serving himself.\n   - A customer is at a small table on the right side, perhaps eating.\n\n3. **Mug:**\n   - Individuals have beverages in their hands and cups, contributing to the social and relaxed atmosphere.\n\n4. **Background:**\n   - Several smaller tables and stools, possibly for ordering plates of food.\n   - A wall hangs with a sign that reads \u201cMuyonola Mamok\u201d in the upper-right corner, likely advertising a dining or cooking service.\n\n**Additional Details:**\n- **Time:**\n   - The time displayed on the image is \"Midnight 11-7-2024,\" indicating the image was shot around midnight using the date as the overlay marker.\n- **Camera and View:**\n   - The camera is positioned in the upper center, providing a high-angle view of the area.\n\n**Analysis and Context:**\n- The image provides an insight into a typical day at an open-air dining or market place.\n- The interactions of people suggest casual dining activities, socializing, and transactions, typical of many urban meal-sharing venues.\n- The setting and attire of the individuals, along with the ambiance, hint at public socialization commonly seen in informal street markets or casual dining places.\n\nThe image captures a slice of everyday life in an urban commercial setting marked by visible human activities and commercial elements.

Frame 2 (00:55) : The image captures a scene from a public place, specifically a street vendor booth in what appears to be the Philippines. Here is a detailed description:\n\n1. **Foreground and Subjects:**\n   - In the foreground, there's an individual holding a phone. This person is partially visible, seated on the ground. \n   - There are several customers in the booth: one person on the left side, a woman sitting at a table, other individuals in different postures around the table, and a person seated on the right side holding a phone.\n\n2. **Middle Ground and Layout:**\n   - To the right of the booth, there is another booth with a person sitting at a table wearing a blue swimsuit. There is a table covered with a blue cloth and what looks like some food.\n   - In the middle ground, people are seen sitting and standing around the table. There are two women, one in a striped top and another in a blue tank top, with one of them holding something small in one hand.\n\n3. **Backstage View:**\n   - The back of the booth is partially visible and features a metal wire structure, which might be used for storage or display items. There are also several buckets and containers in front of the booth.\n   - On the right side, there is a section with various items, including a green hanging object and stacked containers.\n   - A yellow and orange banner is hanging above the booth, possibly indicating a shop name or a part of the store description.\n   - The booth is equipped with several hanging or hanging items and is set up with a red canvas for protection and cleanliness.\n   - Electrical wires are visible in this section of the booth and the floor.\n\n4. **Lighting and Environment:**\n   - The lighting in the booth area is natural, likely sunlight coming from the windows near the entrance.\n   - The wall of the booth is yellow painted in bright colors, complemented by the vibrant color of the booth setup.\n\n5. **Timestamp:**\n   - At the top left is the timestamp showing \"01-07-2024 01:32:51 PM\", indicating the current time captured by the surveillance camera.\n\nThis image appears to depict a typical street food vendor booth in the Philippines, offering meals for the local street residents. The setting reflects a mix of daily activities centered around food preparation and sale in an informal, small-scale setting.

Frame 3 (01:01) : The image shows a street scene from a surveillance camera, marked as being taken on Thursday, 10 September 2024, at 3:32 PM. The camera's timestamp reads \"11-07-24 Thu 10:32:23 PM\". \n\nThe scene is set in an informal, small-scale setting. It appears to be a street cafe, judging by seating, food stalls, and hanging signage. The location is labeled \"Edge Babor Philippines,\" suggesting it's either at a street vendor or a market setting.\n\nSeveral people are present in the image, engaged in various activities. On the left, there\u2019s a woman operating a phone in a white dress. Adjacent to her, several tables are set outside on the sidewalk. These tables have various food and drink containers, like large containers of corn or tomato soup, and some containers are white.\n\nOn the street level, a person is sitting on a bench and seems to be focusing on a mobile phone. Another individual is seated at a small table, likely preparing breakfast for the neighbors, judging by the dish and utensils on it. Two people are sitting at tables, one with a drink and the other with food, indicating a casual dining area. \n\nNear the stalls, there are large jars of ingredients like a can of corn or tomato, and an assortment of utensils are visible on the tables. \n\nAdditionally, there are other signs and possibly posters hanging in the area, but the text on them is not clearly legible due to the image resolution and the angle of the camera.\n\nOverall, the scene portrays a normal, everyday social dining environment within an informal market or possibly a street cafe setting.

Frame 4 (01:23) : The image appears to be an 8-bit video still (known as a Top Hat), capturing a scene in a small, informal eatery or stall in a street setting. To assist in a detailed description:\n\n1. **Objects and Characters**:\n   - **Stalls**: There are a number of stalls, including a few in the background, under which items appear stacked.\n   - **Sitting People**: Several people are seated and engaged in various activities. The ones sitting on the ground typically seem to be enjoying their meals. The person at the bottom right seems to be eating and sitting at a small table with a plate of food. The setting suggests a bustling atmosphere with people engaged in meal times.\n   - **Signage**: Above one stall, there is a sign that reads, \"Mysonla Hamok NA A\" followed by \"CHICKEN 40.00\" on another stall, indicating the prices and items featured. This setting suggests they might be selling chicken.\n   - **Miscellaneous Items**: Various items are placed on the tables, possibly for sale or serving purposes.\n\n2. **Setting & Lighting**:\n   - The image showcases the interior of the stalls with tiled floors. There are noticeable shadows and areas where an overhead light is necessary, suggesting day time or low natural light.\n   - Electrical wires and a dark ground indicate an outdoor location, possibly in a populated, less urban area.\n\n3. **Date and Time Information**:\n   - The timestamp on the top right (image caption) indicates the location is in the Philippines.\n   - The date is 11-07-2021 Thursday, 8:33:29 AM.\n\n4. **Details of Stalls and People**:\n   - Most stalls display offerings like food with visible labels and pricing, likely chicken.\n   - The person eating at the bottom right is possibly taking a snack, judging by the casual demeanor, but it is hard to determine the exact type of food from this angle.\n\n5. **Ambiance**:\n   - The scene appears casual and possibly community-focused, with no excessive hustle or crowd. The arrangement of people suggests social dining, common in places like street food stalls.\n\nIn summary, the image shows a candid scene where people are seen enjoying their time at small food stalls in a localized, street-structured environment. The timestamp, date, and street-style appearance help place the image in an everyday context, providing insights into what everyday Filipino life might look like.

Frame 5 (02:34) : The image appears to capture a vibrant street scene in a dimly lit, possibly under-shaded area, suggesting a market or eating street. It seems to feature a small cafe or vending street teeming with activity and bustling commerce.\n\n1. **Environment and Setting**:\n   - The scene is set outdoors on a narrow, potentially alleyway bordered on both sides by walls and doors.\n   - The street floor is dark and wet, possibly indicating recent rain.\n   - The building walls look aged, with yellow and worn paint, adding to the street's character.\n\n2. **Products and People**:\n   - Various stalls and vendor areas are visible.\n   - There are tables covered with plastic sheeting to protect floors and tables while selling items.\n   - People are seated at these tables, focusing on cooking or eating, engaging in social interactions or waiting for their purchases.\n\n3. **Foreground Details**:\n   - On the left side, an area with a wooden door features a person focused on something in their hands, possibly at a contactless checkout or mobile phone call.\n   - In the mid-ground section, individuals are spread out across tables, engaging in meals and conversations with others.\n   - At the center, a woman is actively engaging with her smartphone, while people around her appear engaged in various activities.\n\n4. **Infrastructure and Signage**:\n   - The walls are adorned with various signs and banners, including one that speaks about a store or product, indicating commercial activity.\n   - The image also captures more of the storefronts, with some items prominently displayed or hanging from above.\n   - There is visible greenery and some outdoor stalls, potentially holding food products or serving drinks.\n\n5. **Labels and Branding**:\n   - The photograph displays a timestamp indicating the date and time of capture.\n   - The bottom right corner contains the overlay \"Edge Baboro Philippines\" suggesting the image might be from a video recorded near the Philippine border.\n\nOverall, this image encapsulates the liveliness and diversity of a street market or street vending area, reflecting the bustling activity and social interactions typical of such environments typically found in urban Filipino markets.

Frame 6 (02:55) : In the image, we see an indoor setting that appears to be a small, possibly family-run, restaurant or snack shack. The scene is captured from an overhead view, providing a partial look at the upper right corner. In the image, there are five people, two seated on stools and three standing in the space.\n\nStarting from the far end, the person sitting on the left is wearing a white shirt and appears engrossed in a mobile phone or a small case. The person sitting on the right wears a purple and yellow striped top and is deeply engrossed in a glass of beer, possibly a pilsner. In the middle of the bar area is a metal table under a weathered yellow awning. Various items, such as plastic bottles, bowls, and containers, are arranged on the table.\n\nAdjacent to the table, there is another person sitting at a stool, further back, attentively eating on a plate. The floor is concrete, and litter and small debris can be seen scattered across it, indicative of either an ongoing meal in progress or an environment that has been cluttered.\n\nTo the right, two seated young users are involved in a meal, likely a sandwich or a quick snack. They are both holding what appears to be a sandwich or a plastic meal kit, which is a typical setup in such establishments.\n\nOn the left side of the image, the visible environment is cluttered, with items scattered about, suggesting a casual, possibly homely vibe. A few more products like bottles, boxes, and other packaging are visibly present nearby. \n\nIn the distance, there is another small section of the establishment, possibly a counter or another section of the shack. Above and visible outside the bar, there is an awning or plastic wrap that adds to the traditional, possibly street-side setup found in Filipino establishments.\n \nTo the far left is the bar counter with a plastic towel neatly placed over it, possibly to keep the counter clean. The image was taken during the evening, judging by the timestamp and the darkness surrounding the scene. \n\nOverall, the image illustrates a typical scene of a small, informal eatery within an Indonesian or Filipino locale, adding an element of daily life and typical urban street food environments. The focus appears to be on the casual, quick-stuffing and social dining setup where people gather for a quick meal on the go.

Frame 7 (03:15) : The image depicts an indoor scene at a narrow, small eatery, possibly a market or a street vendor stall. There appears to be a large number of people present, suggesting it might be a popular spot catering to diners requiring quick service.\n\n1. **Upper Section**: There's a woman on the left side, dressed in a white tank top and black shorts, seated on a ledge. She seems to be engaged in using her phone or a similar device. Next to her, there's another woman, wearing a striped shirt and jeans. She is seated and appears to be eating or holding something small, possibly a small plate or a snack.\n\n2. **Middle Section**: The center of the image shows an ongoing food preparation area. There is a large appliance that looks like slow cooker or stew pot placed on a covered table. Surrounding this are several other tables with people working or eating. \n    - On one table, there are various bowls, likely filled with dishes.\n    - There's a small trash can placed on the right side of the table.\n\n3. **Lower Section**: The floor is wet, indicating recent activity, possibly pouring a liquid or cleaning. There are some scattered objects on the floor: a small stack of paper towels, some bottles, and other items. There's also a metal object that resembles an electric fan in the background.\n    - The walls of the stall are painted yellow and seem to have some posters or signs written in English and another language. There\u2019s a large door that opens into the stall.\n    - Another table is visible, covered with a blue tablecloth.\n\nThe image also includes timestamp and an overlay text indicating it was taken on 11-07-2024 at 15:23 PM, along with another text \"Edge Baboer Philippines\".\n\nFrom this detailed description, we can infer that the image captures a scene at a small, bustling eatery, which is frequented by several customers. People do not seem to be having a lot of time spent at the stall, which may imply it could be a moment of daily rush hour. The ongoing food production suggests that customers are here to order meals and potentially enjoy a quick meal while the stall staff prepares and serves them. The environment appears somewhat informal and lived-in, with elements of daily life and routine activity depicted.

Frame 8 (03:44) : This image is an internal view of a small, makeshift, makeshift dining hall located in an urban area with various street elements visible around it. The setting appears to be bustling and informal with various objects and stalls placed throughout the space.\n\n**Detailed Description:**\n\n1. **Objects:**\n    - **Doorknob on left door:** Yellow-brown in color.\n    - **Streetlamp:** On top of a shelf with items wrapped in plastic.\n    - **Walls:** Displayed with some graffiti and wear.\n    - **Floor tiles:** Patterned with white and black squares.\n    - **Signage:** Blackboards with signs posted on the wall.\n    - **Containers and Baskets:** Various containers, baskets, and crates visible.\n    - **Barriers**: Slightly covered by tarps and plastic sheets.\n    - **Stall:** Large stall with shelves; tables, chairs, and supplies.\n    - **Television or Screens:** One blue screen is visible, seemingly displaying content or menus.\n    - **Folding Tables:** Arranged, covered with carpets or tarpaulins, but no placemats or napkins.\n    - **Walls:** Wall with various items such as plastic crates and hanging food storage equipment.\n    - **Floor:** Crumbly, possibly dirty, with visible stains and debris.\n    - **Personnel:** In the foreground, two individuals seated at a table engaged in conversation. \n    - **Other People:** In the background, casually placed chairs and objects.\n    - **Gangway:** A pedestrian walkway (ground with slabs) connecting the stalls and street.\n    - **Clock:** Top left is marked with the time (11-07-2024 Tuesday 10:43 PM).\n    - **Video Camera:** Indicated by the video camera at the bottom right corner which captures the scene.\n    - **Background Setting:** Wall covered with various items such as trash cans and trash bags.\n    - **Flooring:** Subtle texture and spots.\n\n2. **General Atmosphere:**\n    - The setting appears informal, with small spaces and scattered items adding to a lived-in feel.\n    - The time indications hint at early evening, and the use of street lamps and signs suggests the area might also be commercial.\n    - This environment suggests a fast-paced, low-income setting, possibly in a bustling urban area.\n\n3. **Additional Context:**\n    - No detailed textual information or additional identifiers about the setting are present.\n    - The casual attire of the individuals suggests this is a regular, possibly immigrant, establishment.\n\n**Contextual Analysis:**\nGiven the scene's informal and somewhat makeshift setup, it might indicate a type of food vending or street-side dining where affordability and simplicity are prioritized. The presence of makeshift stalls, casual attire, and litter points towards a community-centric or subcultural setting, likely indicative of Filipino culture, where small, informal eateries with a mix of personal and communal use are prevalent. The presence of signage in multiple languages suggests this establishment caters to diverse clientele, possibly the Filipino community in the area. \n\nIn terms of the video camera and time, it indicates a real-time capture and possibly monitoring, essential for any footage of this setting. The surveillance camera signals an institutional awareness of the area, likely used to record and monitor activities for safety or improvement purposes.

Frame 9 (04:02) : The image appears to be a surveillance camera from an edge of a small business, likely in an informal setting such as a hut or kiosk. The timestamp on the image is 11-07-2024, Thursday, 10:12 PM.\n\nThe setting looks like an area commonly found in certain urban or peri-urban environments of a country in South-East Asia. The exterior of the shop features yellow walls with some white labels and hanging items. \n\nOn the left side, there's an open wooden door that's part of the stall or kiosk, showcasing an assortment of items usually found in such locations, such as baskets filled with food items labeled \"PORK\" priced at 40 pence. \n\nAbove the door, there's a white banner with a logo and text on it, \"Muyonla Mamok.\" This appears to be a restaurant sign or a restaurant menu. Next to it, there are some other items, possibly including bottles or cans, that could be for beverages.\n\nThere's a small table in front of the stall, holding various items, including food items inside, some metal containers, and perhaps personal items of the stall owner. A customer is sitting at the table beside the stall, interacting with the food. He is wearing a blue and yellow jersey and shorts, seated close to the food items and a metallic bucket. \n\nThe area looks like an outdoor sidewalk on the right side, covered by a partially exposed wooden structure at the edge of the shop's front wall. On this sidewalk, there are plastic chairs, a small rectangular table, and what seem to be more tables covered with blue plastic table cloths.\n\nPeople and common items can be seen on the table. There is a mobile phone resting next to the phone, another electronic device, and some paper goods nearby. The overall scene suggests a casual dining or drinking environment.

Frame 10 (04:45) : The image captures an outdoor scene within what appears to be a small establishment, possibly a market or a street vendor's stall. The storefront has a warm, tiled facade and an open wooden door, which is partially framed by yellow walls. \n\nTwo individuals are present. The person who appears to be standing near the entrance has their back to the camera, wearing a sleeveless gray top and shorts. The third individual is seated indoors on what looks like a small table covered in blue and white patterned cloth. The third person is wearing a multicolored sports jersey with \"2\" on it, suggesting they might be a player. They are engaging with the stall's merchandise or possibly interacting with another person sitting in the second-person's position.\n\nThe stall features an assortment of items: \n- Underneath the entrance, there are several items on a table, including jars, bottles, and a refrigerator filled with food items.\n- The back of a yellow tent or awning is visible, covering the entrance area.\n- A blue folding chair is casually placed near the second person, who seems to be engaged in conversation or shopping.\n- On the wooden floor, clutter of what appears to be utensils, packages, or objects suggesting this could be a food stall or market.\n- Several small stools and tables are scattered around the area for customers to sit and browse.\n\nThe timestamp at the top right corner indicates the date as \"11-07-2024, Thu 10:30 PM.\" The bottom part displays various text, with the text \"Edge Babor Filipinenses\" indicating the place or the source of this surveillance footage.\n\nThe entire scene conveys a vibrant, bustling atmosphere typical of a small-market street or food stall.

END OF VIDEO
==================================================================================================================================
"""
    questions = ["\n\nQuestion : Where is this video taking place (location,town,country,time)?"]
    #questions = ["Where is this video taking place (location,town,country,time)?","Are there people who seem to be moving during a short amount of time?","Do you know at what point in time the man in the front right started to stand up?"]
    # Generate a summary using Qwen05 or Qwen15
    tokenizer,model=open_Qwen05()
    for question in questions :
        prompt=pre_prompt+context+question
        #print("PROMPT :\n"+prompt+"\n\n\n\nANSWER :")

        synthesized_summary = questionQwen(prompt,tokenizer,model)
        
        # Print the result
        print(synthesized_summary)

    clean_cuda()

if __name__ == "__main__":
    main()
